(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ad86694"],{"055f":function(t,e,a){"use strict";var n=a("2912"),s=a.n(n);s.a},2912:function(t,e,a){},"3a23":function(t,e,a){var n=a("694f").f,s=Function.prototype,r=/^\s*function ([^ (]*)/,i="name";i in s||a("3a0f")&&n(s,i,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},"4ef4":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAhdJREFUSA3tVc9rE1EQnnnZ0uDd1N1Yzc1DbkltC0UoFY8FL8V/QBAPKngqIvUkngS1eJAeeuxJ0BY9tHjNwXSDFU+WgKhJ1upBVFKhu2+cl/q2bx8Jm14Kgb4QZubNN983b/YXwKAv7HYAmi5kg1/hUwK6wIAfJPCht/n1uYkNzucvkoQ7RHAOEd5lxNDVXPVTYGKUL+wNFQd/wnkA6bl4qigcuA5Ed1slb1Fjm+X8bSlhWQh64NUapwHoQyT3lnTetI4ZaJ8kTQkUq+j7e7y3RXPFiaD+83VzLH8fJWwTwDUxnB0bqdR3VI1A542U4RVdb9quIwpK+RlCeMwjqiOILS5os+/ySW5xgeTcSyTYRsAhiVTg/Fn2F1y/8cokV34s0Cp7T4Bg1gKc4W7jMaIQN5g4I0k+0jgmYAh85r+y+wthzfWbN1VwIFDyJCPi+D80YXhsk5ghEYVUSSSsQIm6tWansbi7NHLNQaHRqd60rMkVC1iY3iHykA6x4ruIL9L7PurawAL86wfboUvM/Ft59DJhlO0ldELghsq1JV3qhUHK/B3xv7zQ+fgEakNS9IyfzJxO2nYXaUqdgB+yFTunY4ToO/uxwOGvgWbq0x4LpA7qiEeE+Du1pTSAxZE8AUE1rT41b3EkBBwH7vF9vptK0gvAtcyxYKYTAiffNj7yG3Oc36nr/Bnse1wdLNcIwAnFYQoMvv8PA92rX/PN84wAAAAASUVORK5CYII="},"990a":function(t,e,a){var n=a("9b6d");t.exports=Array.isArray||function(t){return"Array"==n(t)}},a1d1:function(t,e,a){"use strict";var n=a("2d2c"),s=a("ea02")(6),r="findIndex",i=!0;r in[]&&Array(1)[r](function(){i=!1}),n(n.P+n.F*i,"Array",{findIndex:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),a("68fb")(r)},ab56:function(t,e,a){"use strict";var n=a("2d2c"),s=a("9102"),r=a("aa91"),i=a("201d"),o=[].sort,c=[1,2,3];n(n.P+n.F*(i(function(){c.sort(void 0)})||!i(function(){c.sort(null)})||!a("b139")(o)),"Array",{sort:function(t){return void 0===t?o.call(r(this)):o.call(r(this),s(t))}})},b139:function(t,e,a){"use strict";var n=a("201d");t.exports=function(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})}},c027:function(t,e,a){var n=a("b429"),s=a("990a"),r=a("f3ae")("species");t.exports=function(t){var e;return s(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!s(e.prototype)||(e=void 0),n(e)&&(e=e[r],null===e&&(e=void 0))),void 0===e?Array:e}},cecc:function(t,e,a){var n=a("c027");t.exports=function(t,e){return new(n(t))(e)}},ea02:function(t,e,a){var n=a("0709"),s=a("240e"),r=a("aa91"),i=a("33f2"),o=a("cecc");t.exports=function(t,e){var a=1==t,c=2==t,l=3==t,u=4==t,d=6==t,p=5==t||d,f=e||o;return function(e,o,g){for(var h,m,v=r(e),b=s(v),w=n(o,g,3),x=i(b.length),y=0,F=a?f(e,x):c?f(e,0):void 0;x>y;y++)if((p||y in b)&&(h=b[y],m=w(h,y,v),t))if(a)F[y]=m;else if(m)switch(t){case 3:return!0;case 5:return h;case 6:return y;case 2:F.push(h)}else if(u)return!1;return d?-1:l||u?u:F}}},fe8f:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"manger-container"}},[a("breadcrumb",{attrs:{list:["教师账户管理"]}}),a("main",{staticClass:"manger-main"},[t.freeFlag?a("section",{ref:"banner",staticClass:"freetime"},[t._m(0),a("div",{staticClass:"free-right"},[a("i",{staticClass:"el-icon-close",on:{click:t.closeBanner}})])]):t._e(),a("section",{staticClass:"apply-for"},[a("p",{staticClass:"title"},[t._v("以下用户申请加入校园号")]),a("el-table",{staticStyle:{width:"100%","max-height":"290px",overflow:"auto"},attrs:{data:t.applyForList,"show-header":!1}},[a("el-table-column",{attrs:{prop:"name",label:"用户名",width:"200"}}),a("el-table-column",{attrs:{label:"手机号",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.phone?a("span",[t._v(t._s(n.phone))]):t._e(),a("span",{attrs:{else:""}},[t._v("暂无")])]}}])}),a("el-table-column",{attrs:{label:"留言",width:"280"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[n.memo?a("span",[t._v("留言 : "+t._s(n.memo))]):a("span",[t._v("暂无")])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleApplyFor(n,"pass")}}},[t._v("通过\n            ")]),a("el-button",{staticStyle:{color:"#409EFF"},attrs:{size:"mini",type:"primary",plain:""},on:{click:function(e){return t.handleApplyFor(n,"reject")}}},[t._v("拒绝\n            ")])]}}])})],1)],1),a("section",{staticClass:"add"},[a("div",{staticClass:"add-btn"},[a("el-button",{staticClass:"add-once",attrs:{type:"primary",size:"small"},on:{click:t.addOnce}},[t._v("新增")]),a("el-button",{staticClass:"add-batch",attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.$router.push({name:"Mbtach"})}}},[t._v("批量添加\n        ")])],1),a("el-table",{staticClass:"add-table",staticStyle:{width:"100%","max-height":"580px"},attrs:{data:t.addList}},[a("el-table-column",{attrs:{prop:"nickname",label:"昵称"}}),a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),a("el-table-column",{attrs:{prop:"phone",label:"账号(手机号)"}}),a("el-table-column",{attrs:{prop:"status_text",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",{style:{color:1==n.status?"#606266":"#E6321A"}},[t._v(t._s(n.status_text))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleUser(n,"edit")}}},[t._v("编辑\n            ")]),a("div",{staticClass:"border"}),a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.handleUser(n,"delete")}}},[t._v("删除\n            ")])]}}])})],1),a("div",{staticClass:"record-pagination-wrap"},[JSON.stringify(t.addList)!=JSON.stringify([])?a("el-pagination",{staticClass:"add-pagination",attrs:{layout:"total, prev, pager, next","page-count":t.pagination.totalPages,"pager-count":t.pagination.pagerCount,"page-size":t.pagination.maxSize,total:t.pagination.totalSize},on:{"current-change":t.currentChange}}):t._e()],1)],1)]),a("el-dialog",{staticClass:"dialog-overflow",attrs:{visible:t.overflowFlag,width:"25%",center:""},on:{"update:visible":function(e){t.overflowFlag=e}}},[a("div",{staticClass:"overflow-content"},[a("i",{staticClass:"el-icon-warning overflow-icon"}),a("p",{staticClass:"overflow-text text-first"},[t._v("最多只能添加500个账户")]),a("p",{staticClass:"overflow-text text-second"},[t._v("请删除不用的账户然后再试或联系教习网客服")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"overflow-btn",attrs:{type:"primary"},on:{click:function(e){t.overflowFlag=!1}}},[t._v("我知道了")])],1)]),a("el-dialog",{staticClass:"dialog-once",attrs:{title:"新增账号",visible:t.addOnceFlag,width:"25%",center:""},on:{"update:visible":function(e){t.addOnceFlag=e}}},[a("el-form",{ref:"addOnce",staticClass:"once-form",attrs:{model:t.addInfo,"label-position":"left",rules:t.rules}},[a("el-form-item",{attrs:{label:"姓名","label-width":t.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入姓名",size:"small"},model:{value:t.addInfo.name,callback:function(e){t.$set(t.addInfo,"name",e)},expression:"addInfo.name"}})],1),a("el-form-item",{attrs:{label:"手机号","label-width":t.formLabelWidth,prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入手机号",size:"small"},model:{value:t.addInfo.phone,callback:function(e){t.$set(t.addInfo,"phone",e)},expression:"addInfo.phone"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")])],1)],1),a("el-dialog",{staticClass:"dialog-success",attrs:{visible:t.successFlag,width:"25%",center:""},on:{"update:visible":function(e){t.successFlag=e}}},[a("div",{staticClass:"success-content"},[a("i",{staticClass:"el-icon-success success-icon"}),a("p",{staticClass:"success-text text-first"},[t._v("添加成功")]),a("p",{staticClass:"success-text text-second"},[t._v("用户名 (手机号即为用户名) 和初始密码已通过短信发送至老师手机上，请提醒老师及时激活使用。")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"success-btn",attrs:{type:"primary",plain:""},on:{click:t.addContinue}},[t._v("继续添加")]),a("el-button",{staticClass:"success-btn",staticStyle:{width:"98px"},attrs:{type:"primary"},on:{click:function(e){t.successFlag=!1}}},[t._v("完成")])],1)]),a("el-dialog",{staticClass:"dialog-success dialog-reject",attrs:{visible:t.existFlag,width:"25%",center:""},on:{"update:visible":function(e){t.existFlag=e}}},[a("div",{staticClass:"success-content"},[a("i",{staticClass:"el-icon-warning success-icon"}),a("p",{staticClass:"success-text text-first"},[t._v("添加失败")]),a("p",{staticClass:"success-text text-second"},[t._v(t._s(t.warnMessage))])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"success-btn",attrs:{type:"primary",plain:""},on:{click:t.addContinue}},[t._v("继续添加")]),a("el-button",{staticClass:"success-btn",staticStyle:{width:"98px"},attrs:{type:"primary"},on:{click:function(e){t.existFlag=!1}}},[t._v("完成")])],1)]),a("el-dialog",{staticClass:"dialog-once",attrs:{title:"编辑账号",visible:t.editFlag,width:"25%",center:""},on:{"update:visible":function(e){t.editFlag=e}}},[a("el-form",{ref:"editForm",staticClass:"once-form",attrs:{model:t.editInfo,"label-position":"left",rules:t.rules}},[a("el-form-item",{attrs:{label:"姓名","label-width":t.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入姓名",size:"small"},model:{value:t.editInfo.name,callback:function(e){t.$set(t.editInfo,"name",e)},expression:"editInfo.name"}})],1),a("el-form-item",{attrs:{label:"手机号","label-width":t.formLabelWidth,prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入手机号",size:"small",disabled:""},model:{value:t.editInfo.phone,callback:function(e){t.$set(t.editInfo,"phone",e)},expression:"editInfo.phone"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editFormSubmit()}}},[t._v("确 定")])],1)],1),a("el-dialog",{staticClass:"dialog-success",attrs:{visible:t.editSuccessFlag,width:"25%",center:""},on:{"update:visible":function(e){t.editSuccessFlag=e}}},[a("div",{staticClass:"success-content"},[a("i",{staticClass:"el-icon-success success-icon"}),a("p",{staticClass:"success-text text-first"},[t._v("编辑成功")])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"success-btn",attrs:{type:"primary"},on:{click:function(e){t.editSuccessFlag=!1}}},[t._v("完成")])],1)])],1)},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"free-left"},[n("i",{staticClass:"free-box"},[n("img",{attrs:{src:a("4ef4"),alt:"礼物盒",width:"24"}})]),n("span",{staticStyle:{"margin-left":"5px","margin-right":"30px"}},[t._v("成功添加并激活10名教师账号可免费获取30天的免费使用时间~")])])}],r=(a("ab56"),a("3a23"),a("f46d")),i=a.n(r),o=(a("a1d1"),a("b5aa"),a("2c46")),c={name:"Manger",data:function(){var t=function(t,e,a){if(!e)return a(new Error("手机号不能为空"));var n=/^1[3|4|5|7|8][0-9]\d{8}$/;if(!n.test(e.trim()))return a(new Error("请输入正确的手机号"));a()},e=function(t,e,a){var n=/^[\u2E80-\u9FFF]+$/;e&&e.length>0?n.test(e.trim())?a():a([new Error("姓名输入不合法")]):0==e.trim().length?a(new Error("请输入姓名")):a(new Error("姓名输入不合法"))};return{group_id:null,token:null,applyForList:[],addList:[],pagination:{totalPages:25,pagerCount:5,maxSize:8,totalSize:400},currentPage:1,formLabelWidth:"60px",addInfo:{name:"分割",phone:"13699815295"},warnMessage:"",editInfo:{name:"",phone:""},editIndex:null,rules:{name:[{validator:e,trigger:"blur"}],phone:[{validator:t,trigger:"blur"}],subject:[{required:!0,message:"请选择学科",trigger:"change"}],grade:[{required:!0,message:"请选择年级",trigger:"change"}]},overflowFlag:!1,addOnceFlag:!1,successFlag:!1,existFlag:!1,editFlag:!1,editSuccessFlag:!1}},methods:{closeBanner:function(){this.$refs.banner.style.display="none",this.$tools.setSto({key:"banner",val:1})},handleApplyFor:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e,a){var n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$axios.put("groups/".concat(this.group_id,"/member_applies/").concat(e.id,"/").concat(a),{},{headers:{Authorization:"Bearer ".concat(this.token)}});case 2:n=t.sent,console.log(n),200===n.code?this.$message({type:"success",message:n.data}):this.$message({type:"error",message:"系统繁忙, 请稍后重试 !"}),this.getApplyList(),this.getNewList();case 7:case"end":return t.stop()}},t,this)}));function e(e,a){return t.apply(this,arguments)}return e}(),handleUser:function(t,e){var a=this,n=this.addList.findIndex(function(e){return e.phone===t.phone});"edit"===e?(this.editInfo=JSON.parse(i()(t)),this.editFlag=!0,this.editIndex=n):"delete"===e?this.$confirm("将删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark(function e(){var s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.$axios.delete("groups/".concat(a.group_id,"/members/").concat(t.id),{headers:{Authorization:"Bearer ".concat(a.token)}});case 2:s=e.sent,200===s.code&&(a.addList.splice(n,1),a.getNewList(),a.$message({type:"success",message:"删除成功!"}));case 4:case"end":return e.stop()}},e)}))).catch(function(t){console.log(t)}):console.error("没有这个操作")},currentChange:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.currentPage=e,this.getList();case 2:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),addOnce:function(){if(this.pagination.totalSize>=500)return this.overflowFlag=!0,!1;this.addOnceFlag=!0},submitForm:function(){var t=this;this.$refs.addOnce.validate(function(e){if(e){var a=new XMLHttpRequest,n=null;a.onreadystatechange=function(){4===a.readyState&&200===a.status?(t.group_id=1,t.currentPage=1,t.pagination.maxSize=8,t.getNewList(),setTimeout(function(){t.successFlag=!0},500),t.$refs.addOnce.resetFields(),t.addOnceFlag=!1,t.addInfo.name=t.addInfo.phone=""):409===a.status&&(n=JSON.parse(a.responseText),"已是团体成员"==n.message?t.warnMessage="该账户已存在，无需再添加":"是别的团体的成员"==n.message&&(t.warnMessage="该手机号已关联其它校园通账户，若要关联到本学校，请账号所有者先退出原校园通。"),console.log(n.message),setTimeout(function(){t.existFlag=!0},500),t.$refs.addOnce.resetFields(),t.addOnceFlag=!1,t.addInfo.name=t.addInfo.phone="")},a.open("post","http://school.test.51jiaoxi.com/api/groups/".concat(t.group_id,"/members")),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Bearer ".concat(t.token)),a.send(i()(t.addInfo))}else console.log("error submit!!")})},editFormSubmit:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:console.log(1),this.$refs.editForm.validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(a){var n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=7;break}return t.next=3,e.$axios.put("groups/".concat(e.group_id,"/members/").concat(e.editInfo.id,"?name=").concat(e.editInfo.name.trim()),{},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.token)}});case 3:n=t.sent,200===n.code?(e.addList[e.editIndex]=e.editInfo,e.getNewList(),e.editFlag=!1,setTimeout(function(){e.editSuccessFlag=!0},500)):e.$message({type:"error",message:"编辑失败, 请稍后重试!"}),t.next=8;break;case 7:console.log("error submit!!");case 8:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),addContinue:function(){this.successFlag=this.existFlag=!1,this.addOnceFlag=!0,this.$refs.addOnce.resetFields(),this.addInfo.name=this.addInfo.phone=""},getNewList:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$axios.get("groups/".concat(this.group_id,"/members"),{headers:{Authorization:"Bearer ".concat(this.token)}});case 2:e=t.sent,this.pagination.totalSize=e.data.length,this.getList();case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getList:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$axios.get("groups/".concat(this.group_id,"/members?page=").concat(this.currentPage,"&per_page=").concat(this.pagination.maxSize),{headers:{Authorization:"Bearer ".concat(this.token)}});case 2:e=t.sent,a=e.data,a.sort(this.$tools.sort("status",!0)),this.addList=a;case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),getApplyList:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$axios.get("groups/".concat(this.group_id,"/member_applies"),{headers:{Authorization:"Bearer ".concat(this.token)}});case 2:e=t.sent,this.applyForList=e.data;case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},computed:{freeFlag:function(){var t=this.$tools.getSto("banner");return(this.$store.state.userInfo.active_member_count<10||this.$store.state.userInfo.inactive_member_count<10)&&(0===t||void 0)}},created:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=this.$tools.getSto("group_id"),a=this.$tools.getSto("token"),this.group_id=e,this.token=a,this.getApplyList(),this.getNewList();case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},l=c,u=(a("055f"),a("17cc")),d=Object(u["a"])(l,n,s,!1,null,"11252f9e",null);e["default"]=d.exports}}]);